<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .profile-image {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin: 10px 0;
      border: 5px solid white;
      object-fit: cover;
    }
    .input-field {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    .input-field input {
      padding: 8px;
      margin-right: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 250px;
    }
    .input-field button {
      padding: 8px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
    }
    .save-changes-button {
      padding: 12px 20px;
      cursor: pointer;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      margin-top: 20px;
    }
    .upload-button {
      padding: 10px 15px;
      cursor: pointer;
      background-color: #ffc107;
      color: white;
      border: none;
      border-radius: 5px;
    }
    .change-password-button {
      padding: 10px 15px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h1>
    <img id="profile-image" class="profile-image" src="https://via.placeholder.com/150?text=%D8%A3%D8%B6%D9%81+%D8%B5%D9%88%D8%B1%D8%A9" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ">

    <form id="profile-form">
      <div class="input-field">
        <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" required>
      </div>
      <div class="input-field">
        <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" disabled>
      </div>
      <div class="input-field">
        <input type="tel" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
      </div>
      <!-- Ø­Ù‚Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
      <div class="input-field">
        <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
        <button type="button" id="toggle-password" style="background: none; border: none; cursor: pointer; font-size: 16px;">ğŸ‘ï¸</button>
      </div>
      <button class="upload-button" type="button" onclick="uploadImage()">Ø±ÙØ¹ ØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ©</button>
      <button class="save-changes-button" type="submit">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
    </form>

    <!-- Ø²Ø± ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
    <button class="change-password-button" onclick="window.location.href = 'change-password.html'">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
  </div>

  <script>
    window.onload = function() {
      // ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙÙŠ localStorage
      const email = localStorage.getItem('userEmail');
      if (!email) {
        alert("ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
        window.location.href = 'login.html'; // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        return;
      }

      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† localStorage
      const userData = JSON.parse(localStorage.getItem(email));
      if (userData) {
        document.getElementById('username').value = userData.username;
        document.getElementById('email').value = userData.email;
        document.getElementById('phone').value = userData.phone;
        document.getElementById('profile-image').src = userData.profileImage || 'https://via.placeholder.com/150?text=%D8%A3%D8%B6%D9%81+%D8%B5%D9%88%D8%B1%D8%A9';
        document.getElementById('password').value = userData.password || '';
      }
    }

    // Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„ØªÙŠ ÙŠÙ‚ÙˆÙ… Ø¨Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    document.getElementById('profile-form').addEventListener('submit', function(e) {
      e.preventDefault();

      const email = localStorage.getItem('userEmail');
      const username = document.getElementById('username').value;
      const phone = document.getElementById('phone').value;
      const password = document.getElementById('password').value;

      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† localStorage
      const userData = JSON.parse(localStorage.getItem(email));
      if (userData) {
        userData.username = username;
        userData.phone = phone;
        userData.password = password;
        
        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© ÙÙŠ localStorage
        localStorage.setItem(email, JSON.stringify(userData));
        alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
        window.location.href = 'welcome.html';  // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
      }
    });

    // Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
    function uploadImage() {
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = 'image/*';
      fileInput.addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = function(event) {
          const userData = JSON.parse(localStorage.getItem(localStorage.getItem('userEmail')));
          userData.profileImage = event.target.result;
          document.getElementById('profile-image').src = event.target.result;
          localStorage.setItem(userData.email, JSON.stringify(userData));
        }
        reader.readAsDataURL(e.target.files[0]);
      });
      fileInput.click();
    }

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    const togglePasswordButton = document.getElementById('toggle-password');
    togglePasswordButton.addEventListener('click', function() {
      const passwordInput = document.getElementById('password');
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        togglePasswordButton.textContent = 'ğŸ™ˆ';
      } else {
        passwordInput.type = 'password';
        togglePasswordButton.textContent = 'ğŸ‘ï¸';
      }
    });
  </script>
</body>
</html>
